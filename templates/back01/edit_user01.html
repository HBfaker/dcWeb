{% extends 'back01/base.html' %}
{% block static_files %}
<script src="{{url_for('static',filename='js/jquery-2.1.0.min.js')}}"></script>

<script src="{{url_for('static',filename='js/bootstrap.js')}}"></script>


{% endblock %}
{% block body_part %}

     <section id="main-content">
      <section class="wrapper">
        <div class="row">
          <div class="col-lg-10">
            <h3 class="page-header"><i class="fa fa-file-text-o"></i> 编辑人员</h3>
            <ol class="breadcrumb">
              <li><i class="fa fa-home"></i><a href="index.html">主页</a></li>
              <li><i class="icon_document_alt"></i>人员管理</li>
              <li><i class="fa fa-file-text-o"></i>编辑人员</li>
            </ol>
          </div>
        </div>

        <!-- Basic Forms & Horizontal Forms-->

        <div class="row">
          <div class="col-lg-12">
            <section class="panel">
              <header class="panel-heading">
                基本信息
              </header>
              <div class="panel-body">
   <ul>
        <table  class="table table-striped table-advance table-hover">
                 <thead>
                    <tr>
                        <th width="1%"><i class="icon_cogs"></i></th>
                        <th width="30%"><i class="icon_profile"></i>用户名</th>
                        <th width="6%"><i class="icon_calendar"></i>添加时间</th>
                        <th width="3%"><i class="icon_cogs"></i>编辑</th>
                    </tr>
                 </thead>
                <tbody>
                  {% for user in users %}

                <tr data-id="{{ user.id }}" data-title="{{ user.title }}" data-content="{{ user.content }}">
                  <td scope="row" width="1%"><img src="{{ url_for('static',filename='img/right.gif') }}"></td>
                  <td style="overflow:hidden;white-space:nowrap;text-overflow:ellipsis;" width="30%">
                      {{ user.username }}
                  </td>
                  <td  width="6%">
                      {{ user.created_time }}
                  </td>
                  <td width="3%">
                                <div data-id="{{user.id}}" class="btn-group">
                                    <a class="btn btn-danger" ><i id="del-btn" class="icon_close_alt2 del-btn">删除</i></a>
                                </div>
                  </td>
                </tr>
                {% endfor %}
                </tbody>
        </table>
    </ul>


    <div>
        <nav aria-label="Page navigation">
            <ul class="pagination">
                {% if pagination.has_prev %}
                    <li class="page-item">
                        <a class="page-link"
                           href="{{ url_for('back01.userlist01',page=pagination.page-1) }}">上一页</a>
                    </li>
                {% endif %}


                {% for p in pagination.iter_pages() %}

                    {% if p == pagination.page %}
                        <li class="page-item active">
                            <a class="page-link" href="{{ url_for('back01.userlist01', page = p) }}">{{ loop.index }}</a>
                        </li>
                    {% else %}
                        <li class="page-item">
                            <a class="page-link" href="{{ url_for('back01.userlist01',page = p) }}">{{ loop.index }}</a>
                        </li>
                    {% endif %}
                {% endfor %}

                {% if pagination.has_next %}
                    <li class="page-item">
                        <a class="page-link" href="{{ url_for('back01.userlist01',page=pagination.page+1)}}">下一页</a>
                    </li>
                {% endif %}
            </ul>
        </nav>
    </div>



              </div>
            </section>
          </div>

        </div>


            </div>
          </div>
        </div>
        <!-- page end-->
      </section>
    </section>
<script>
$(function () {
   $(".del-btn").click(function (event) {
       event.preventDefault();
       var data =  {};
       var self = $(this);
       var divTag = self.parent().parent().parent().parent();
       var id = divTag.attr('data-id');
       console.log(id);
       data['id'] = id;
       console.log(data);

        $.ajax({
              url: '/back01/deluser',
              type: 'post',
              data: JSON.stringify(id),
              dataType: 'json',
              success: function (data) {
                  alert(data.message)
                  window.location.href = "/back01/userlist01"
              },
              error: function (data) {
                  alert(data.message)

              }
          });
   });
});
</script>
{% endblock %}