{% extends 'back01/base.html' %}

{% block static_files %}
<script src="{{url_for('static',filename='js/jquery-2.1.0.min.js')}}"></script>
<script src="{{url_for('static',filename='js/bootstrap.js')}}"></script>

{% endblock %}

{% block body_part %}

<section id="main-content">
    <section class="wrapper">
        <div class="row">
            <div class="col-lg-12">
                <ol class="breadcrumb">
                    <li><i class="fa fa-home"></i><a href="index.html">主页</a></li>
                    <li><i class="icon_document_alt"></i>基地管理</li>
                </ol>
            </div>
        </div>
        <!-- Form validations -->
        <!--<div class="row">-->
            <!--<div class="col-lg-12">-->
                <!--<a class="btn btn-info btn-lg" href="{{url_for('back01.lab_create')}}"><span class="glyphicon glyphicon-plus"></span>添加实验室</a>-->
            <!--</div>-->
        <!--</div>-->

        <div class="row">
            <div class="col-lg-12">
                <table class="table table-striped table-advance table-hover">
                    <thead>
                    <tr>
                        <th><i class="icon_profile"></i>实验室名称</th>
                        <th><i class="icon_calendar"></i>创建时间</th>
                        <th><i class="icon_cogs"></i>编辑</th>
                    </tr>
                    </thead>
                    <tbody>
                    {% for lab in labs %}
                        <tr >
                            <td><a href="{{ url_for('back01.lab_detail',lab_id=lab.id) }}">{{ lab.name }}</a></td>
                            <td>{{lab.create_time}}</td>
                            <td>
                                <div class="btn-group">
                                    <a href="{{ url_for('back01.lab_update',lab_id=lab.id) }}" class="btn btn-primary"><i class="icon_check_alt2"></i>修改</a>
                                    <a href="javascript:void(0);" class="btn btn-danger delete" id="lab_id" lab_id="{{ lab.id }}"><i class="icon_close_alt2"></i>删除</a>
                                </div>
                            </td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
        <div class="text-center row">
            <div class="col-lg-12">
                <ul class="pagination pagination-lg">
                    {% if pagination.has_prev %}
                        <li><a href="{{url_for('back01.lab',page = pagination.page - 1)}}">«</a></li>
                    {% endif %}

                    {% for p in pagination.iter_pages() %}
                        {% if p == pagination.page%}
                             <li class="active"><a href="{{url_for('back01.lab',page = p)}}">{{loop.index}}</a></li>
                        {% else %}
                            <li><a href="{{url_for('back01.lab',page = p)}}">{{loop.index}}</a></li>
                        {% endif %}
                    {% endfor %}

                    {% if pagination.has_next %}
                        <li><a href="{{url_for('back01.lab',page = pagination.page + 1)}}">»</a></li>
                    {% endif %}
                </ul>
            </div>
        </div>


    </section>
</section>

<script>
$(function () {
     $(".delete").click(function () {
      if (delete_confirm()) {
          var data = {};
          data['id'] = $(this).attr('lab_id');

          $.ajax({
              url: '/back01/lab/delete',
              type: 'post',
              data: JSON.stringify(data),
              dataType: 'json',
              success: function (data) {
                  alert(data.info);
                  window.location.href="/back01/lab"
              },
              error: function (data) {
                  alert(data.info)

              }
          });
      }
      else {
        window.location.href="/back01/lab"
      }


          });

  function delete_confirm() {
       if (window.confirm('确定删除吗？')){
           return true;
       }
       else{
           return false;
       }
  }
});



</script>


{% endblock %}