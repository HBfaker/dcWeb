{% extends 'back01/base.html' %}

{% block static_files %}
<script src="{{url_for('static',filename='js/jquery-2.1.0.min.js')}}"></script>
<script src="{{url_for('static',filename='js/bootstrap.js')}}"></script>

{% endblock %}

{% block body_part %}

<section id="main-content">
    <section class="wrapper">
        <div class="row">
            <div class="col-lg-12">
                <ol class="breadcrumb">
                    <li><i class="fa fa-home"></i><a href="index.html">主页</a></li>
                    <li><i class="icon_document_alt"></i>基地管理</li>
                </ol>
            </div>
        </div>
        <!-- Form validations -->
        <div class="row">
            <div class="col-lg-12">
                <a class="btn btn-info btn-lg" href="{{url_for('back01.lab_create')}}"><span class="glyphicon glyphicon-plus"></span>添加实验室</a>
            </div>
        </div>

        <div class="row">
            <div class="col-lg-12">
                <table class="table table-striped table-advance table-hover">
                    <thead>
                    <tr>
                        <th><i class="icon_profile"></i>实验室名称</th>
                        <th><i class="icon_calendar"></i>创建时间</th>
                        <th><i class="icon_cogs"></i>编辑</th>
                    </tr>
                    </thead>
                    <tbody>
                    {% for lab in labs %}
                        <tr id="lab_id" lab_id="{{ lab.id }}">
                            <td><a href="{{ url_for('back01.lab_detail',lab_id=lab.id) }}">{{ lab.name }}</a></td>
                            <td>{{lab.create_time}}</td>
                            <td>
                                <div class="btn-group">
                                    <a href="{{ url_for('back01.lab_update',lab_id=lab.id) }}" class="btn btn-primary"><i class="icon_check_alt2"></i>修改</a>
                                    <a href="javascript:void(0);" class="btn btn-danger" id="submit"><i class="icon_close_alt2"></i>删除</a>
                                </div>
                            </td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>

            </div>
        </div>


    </section>
</section>

<script>
  $("#submit").click(function () {
      if (delete_confirm()) {

          var data = {};
          data['id'] = $("#lab_id").attr('lab_id');

          $.ajax({
              url: '/api/lab/delete',
              type: 'post',
              data: JSON.stringify(data),
              dataType: 'json',
              success: function (data) {
                  alert(data.info);
                  window.location.href="/back01/lab"
              },
              error: function (data) {
                  alert(data.info)

              }
          });
      }
      else {
        window.location.href="/back01/lab"
      }


          });

  function delete_confirm() {
       if (window.confirm('确定删除吗？')){
           return true;
       }
       else{
           return false;
       }
  }


</script>


{% endblock %}